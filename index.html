<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Game 1</title>
    <script type="text/javascript" src="Engine/Engine.js"></script>
    <script type="text/javascript" src="Objects/Box.js"></script>
    <script type="text/javascript" src="Objects/Wall.js"></script>
    <script type="text/javascript" src="Objects/Snake.js"></script>
    <script type="text/javascript" src="Objects/Food.js"></script>
</head>
<body>

<div id="game"></div>
<script type="text/javascript">

    var size = new Size(
        window.innerWidth - 25,
        window.innerHeight - 25,
    );

    function rand(from, to) {
        return Math.round(Math.random() * to) + from;
    }

    setupEngine('game', size).then(function (screen) {
        Canvas().style.background = 'rgb(124,166,92)';

        var keyboard = new KeyboardInput();
        var snake = new Snake(size.width/2,size.height/2, 10, 10);
        var wall = new Wall(size);
        var food = new Food(rand(12, screen.width/2), rand(12, screen.height/2), 12, 12);

        var img = new Image();
        img.src = 'http://davetayls.me/space-invaders/ui/sprites.png';
        var sprite = new SpriteSheet(img.src, 32, 16, [
            // specify a few sprite locations
            [10, 523],  // green
            [131, 523], // pink
            [191, 523]  // hit
        ]);


        setInterval(function () {
            screen.Clear();

            var keyCode = keyboard.getKey();
            var stepsize = 5;

            switch(keyCode) {
                case keyboard.KEY_UP:
                    snake.vely = -stepsize;
                    snake.velx = 0;
                    break;
                case keyboard.KEY_DOWN:
                    snake.vely = +stepsize;
                    snake.velx = 0;
                    break;
                case keyboard.KEY_LEFT:
                    snake.velx -= stepsize;
                    snake.vely = 0;
                    break;
                case keyboard.KEY_RIGHT:
                    snake.velx = stepsize;
                    snake.vely = 0;
                    break;
            }

            if (wall.Contains(snake.x, snake.y)) {
                snake.x = 12;
            }


            if (food.Contains(snake.x, snake.y)) {
                food.x = rand(12, screen.width/2);
                food.y = rand(12, screen.height/2);

                snake.Grow();
            }

//            image('https://s-media-cache-ak0.pinimg.com/236x/c5/50/c9/c550c9197268aa7f7ef309a7fc81cb33--s-style-nd-avenue.jpg',
//            100, 100, 0,0, 100, 100);

            sprite.Draw(0, 10, 200);
            sprite.Draw(1, 50, 200);
            sprite.Draw(2, 90, 200);


            snake.Draw();
            wall.Draw();
            food.Draw();


        }, 33);
    });


</script>
</body>
</html>